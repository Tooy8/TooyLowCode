{"remainingRequest":"D:\\开源项目\\商城低代码\\mall-cook\\packages\\mall-cook-platform\\node_modules\\babel-loader\\lib\\index.js!D:\\开源项目\\商城低代码\\mall-cook\\packages\\mall-cook-platform\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!D:\\开源项目\\商城低代码\\mall-cook\\packages\\mall-cook-platform\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\开源项目\\商城低代码\\mall-cook\\packages\\mall-cook-platform\\src\\pages\\mall\\goods\\goods-manager\\edit.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\开源项目\\商城低代码\\mall-cook\\packages\\mall-cook-platform\\src\\pages\\mall\\goods\\goods-manager\\edit.vue","mtime":1693619752179},{"path":"D:\\开源项目\\商城低代码\\mall-cook\\packages\\mall-cook-platform\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1693619820390},{"path":"D:\\开源项目\\商城低代码\\mall-cook\\packages\\mall-cook-platform\\node_modules\\babel-loader\\lib\\index.js","mtime":1693619820336},{"path":"D:\\开源项目\\商城低代码\\mall-cook\\packages\\mall-cook-platform\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1693619820390},{"path":"D:\\开源项目\\商城低代码\\mall-cook\\packages\\mall-cook-platform\\node_modules\\vue-loader\\lib\\index.js","mtime":1693619864566}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkQ6L1x1NUYwMFx1NkU5MFx1OTg3OVx1NzZFRS9cdTU1NDZcdTU3Q0VcdTRGNEVcdTRFRTNcdTc4MDEvbWFsbC1jb29rL3BhY2thZ2VzL21hbGwtY29vay1wbGF0Zm9ybS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vYXN5bmNUb0dlbmVyYXRvciI7CmltcG9ydCBfb2JqZWN0U3ByZWFkIGZyb20gIkQ6L1x1NUYwMFx1NkU5MFx1OTg3OVx1NzZFRS9cdTU1NDZcdTU3Q0VcdTRGNEVcdTRFRTNcdTc4MDEvbWFsbC1jb29rL3BhY2thZ2VzL21hbGwtY29vay1wbGF0Zm9ybS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vb2JqZWN0U3ByZWFkMiI7CmltcG9ydCAicmVnZW5lcmF0b3ItcnVudGltZS9ydW50aW1lLmpzIjsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IHsgbWFwR2V0dGVycyB9IGZyb20gInZ1ZXgiOwppbXBvcnQgeyBhZGRHb29kcywgZWRpdEdvb2RzIH0gZnJvbSAiQC9hcGkvZ29vZHMiOwpleHBvcnQgZGVmYXVsdCB7CiAgY3JlYXRlZDogZnVuY3Rpb24gY3JlYXRlZCgpIHsKICAgIHZhciBmb3JtID0gdGhpcy4kcm91dGUucGFyYW1zOyAvLyDku7fmoLzmlLnkuLrlhYPorr7nva4KCiAgICBmb3JtLnByaWNlID0gZm9ybS5wcmljZSA/IGZvcm0ucHJpY2UgLyAxMDAgOiAwOwogICAgZm9ybS5vcmlnaW5hbFByaWNlID0gZm9ybS5vcmlnaW5hbFByaWNlID8gZm9ybS5vcmlnaW5hbFByaWNlIC8gMTAwIDogMDsKICAgIHRoaXMuZm9ybSA9IGZvcm07CiAgfSwKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgZm9ybToge30KICAgIH07CiAgfSwKICBjb21wdXRlZDogX29iamVjdFNwcmVhZCh7fSwgbWFwR2V0dGVycyhbInByb2plY3QiXSkpLAogIG1ldGhvZHM6IHsKICAgIC8vIOaPkOS6pAogICAgc3VibWl0OiBmdW5jdGlvbiBzdWJtaXQoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICB0aGlzLiRyZWZzWyJmb3JtIl0udmFsaWRhdGUoZnVuY3Rpb24gKHZhbGlkKSB7CiAgICAgICAgaWYgKHZhbGlkKSB7CiAgICAgICAgICBfdGhpcy5mb3JtLmlkID8gX3RoaXMuZWRpdCgpIDogX3RoaXMuYWRkKCk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICAvLyDmlrDlop4KICAgIGFkZDogZnVuY3Rpb24gYWRkKCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICAgICAgdmFyIGRhdGEsIF95aWVsZCRhZGRHb29kcywgc3RhdHVzOwoKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBkYXRhID0gX3RoaXMyLmZvcm1hdFBhcmFtcyhfb2JqZWN0U3ByZWFkKHsKICAgICAgICAgICAgICAgICAgcHJvamVjdElkOiBfdGhpczIucHJvamVjdC5pZAogICAgICAgICAgICAgICAgfSwgX3RoaXMyLmZvcm0pKTsKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAzOwogICAgICAgICAgICAgICAgcmV0dXJuIGFkZEdvb2RzKGRhdGEpOwoKICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICBfeWllbGQkYWRkR29vZHMgPSBfY29udGV4dC5zZW50OwogICAgICAgICAgICAgICAgc3RhdHVzID0gX3lpZWxkJGFkZEdvb2RzLnN0YXR1czsKCiAgICAgICAgICAgICAgICBpZiAoc3RhdHVzID09ICIxMDAwMCIpIHsKICAgICAgICAgICAgICAgICAgX3RoaXMyLiRub3RpZnkoewogICAgICAgICAgICAgICAgICAgIHRpdGxlOiAi5oiQ5YqfIiwKICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiAi5ZWG5ZOB5Y+R5biD5oiQ5YqfIiwKICAgICAgICAgICAgICAgICAgICB0eXBlOiAic3VjY2VzcyIKICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICBfdGhpczIuJHJvdXRlci5wdXNoKHsKICAgICAgICAgICAgICAgICAgICBuYW1lOiAiZ29vZHMtbWFuYWdlciIKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUpOwogICAgICB9KSkoKTsKICAgIH0sCiAgICAvLyDnvJbovpEKICAgIGVkaXQ6IGZ1bmN0aW9uIGVkaXQoKSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIoKSB7CiAgICAgICAgdmFyIF95aWVsZCRlZGl0R29vZHMsIHN0YXR1czsKCiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDIpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyLnByZXYgPSBfY29udGV4dDIubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMjsKICAgICAgICAgICAgICAgIHJldHVybiBlZGl0R29vZHMoX3RoaXMzLmZvcm1hdFBhcmFtcyhfdGhpczMuZm9ybSkpOwoKICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICBfeWllbGQkZWRpdEdvb2RzID0gX2NvbnRleHQyLnNlbnQ7CiAgICAgICAgICAgICAgICBzdGF0dXMgPSBfeWllbGQkZWRpdEdvb2RzLnN0YXR1czsKCiAgICAgICAgICAgICAgICBpZiAoc3RhdHVzID09ICIxMDAwMCIpIHsKICAgICAgICAgICAgICAgICAgX3RoaXMzLiRub3RpZnkoewogICAgICAgICAgICAgICAgICAgIHRpdGxlOiAi5oiQ5YqfIiwKICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiAi5ZWG5ZOB5L+u5pS55oiQ5YqfIiwKICAgICAgICAgICAgICAgICAgICB0eXBlOiAic3VjY2VzcyIKICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICBfdGhpczMuJHJvdXRlci5wdXNoKHsKICAgICAgICAgICAgICAgICAgICBuYW1lOiAiZ29vZHMtbWFuYWdlciIKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMik7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIGZvcm1hdFBhcmFtczogZnVuY3Rpb24gZm9ybWF0UGFyYW1zKHRhcmdldCkgewogICAgICB2YXIgZGF0YSA9IHRoaXMuJGNsb25lRGVlcCh0YXJnZXQpOyAvLyDku7fmoLzkuLrnu5/kuIDkuLrliIYKCiAgICAgIGRhdGEucHJpY2UgPSBkYXRhLnByaWNlICogMTAwOwogICAgICBkYXRhLm9yaWdpbmFsUHJpY2UgPSBkYXRhLm9yaWdpbmFsUHJpY2UgKiAxMDA7CiAgICAgIHJldHVybiBkYXRhOwogICAgfQogIH0KfTs="},{"version":3,"sources":["edit.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2EA,SAAA,UAAA,QAAA,MAAA;AACA,SAAA,QAAA,EAAA,SAAA,QAAA,aAAA;AAEA,eAAA;AACA,EAAA,OADA,qBACA;AACA,QAAA,IAAA,GAAA,KAAA,MAAA,CAAA,MAAA,CADA,CAEA;;AACA,IAAA,IAAA,CAAA,KAAA,GAAA,IAAA,CAAA,KAAA,GAAA,IAAA,CAAA,KAAA,GAAA,GAAA,GAAA,CAAA;AACA,IAAA,IAAA,CAAA,aAAA,GAAA,IAAA,CAAA,aAAA,GAAA,IAAA,CAAA,aAAA,GAAA,GAAA,GAAA,CAAA;AACA,SAAA,IAAA,GAAA,IAAA;AACA,GAPA;AAQA,EAAA,IARA,kBAQA;AACA,WAAA;AACA,MAAA,IAAA,EAAA;AADA,KAAA;AAGA,GAZA;AAaA,EAAA,QAAA,oBACA,UAAA,CAAA,CAAA,SAAA,CAAA,CADA,CAbA;AAgBA,EAAA,OAAA,EAAA;AACA;AACA,IAAA,MAFA,oBAEA;AAAA;;AACA,WAAA,KAAA,CAAA,MAAA,EAAA,QAAA,CAAA,UAAA,KAAA,EAAA;AACA,YAAA,KAAA,EAAA;AACA,UAAA,KAAA,CAAA,IAAA,CAAA,EAAA,GAAA,KAAA,CAAA,IAAA,EAAA,GAAA,KAAA,CAAA,GAAA,EAAA;AACA;AACA,OAJA;AAKA,KARA;AAUA;AACA,IAAA,GAXA,iBAWA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AACA,gBAAA,IADA,GACA,MAAA,CAAA,YAAA;AACA,kBAAA,SAAA,EAAA,MAAA,CAAA,OAAA,CAAA;AADA,mBAEA,MAAA,CAAA,IAFA,EADA;AAAA;AAAA,uBAMA,QAAA,CAAA,IAAA,CANA;;AAAA;AAAA;AAMA,gBAAA,MANA,mBAMA,MANA;;AAQA,oBAAA,MAAA,IAAA,OAAA,EAAA;AACA,kBAAA,MAAA,CAAA,OAAA,CAAA;AACA,oBAAA,KAAA,EAAA,IADA;AAEA,oBAAA,OAAA,EAAA,QAFA;AAGA,oBAAA,IAAA,EAAA;AAHA,mBAAA;;AAKA,kBAAA,MAAA,CAAA,OAAA,CAAA,IAAA,CAAA;AAAA,oBAAA,IAAA,EAAA;AAAA,mBAAA;AACA;;AAfA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAgBA,KA3BA;AA6BA;AACA,IAAA,IA9BA,kBA8BA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBACA,SAAA,CAAA,MAAA,CAAA,YAAA,CAAA,MAAA,CAAA,IAAA,CAAA,CADA;;AAAA;AAAA;AACA,gBAAA,MADA,oBACA,MADA;;AAGA,oBAAA,MAAA,IAAA,OAAA,EAAA;AACA,kBAAA,MAAA,CAAA,OAAA,CAAA;AACA,oBAAA,KAAA,EAAA,IADA;AAEA,oBAAA,OAAA,EAAA,QAFA;AAGA,oBAAA,IAAA,EAAA;AAHA,mBAAA;;AAKA,kBAAA,MAAA,CAAA,OAAA,CAAA,IAAA,CAAA;AAAA,oBAAA,IAAA,EAAA;AAAA,mBAAA;AACA;;AAVA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAWA,KAzCA;AA2CA,IAAA,YA3CA,wBA2CA,MA3CA,EA2CA;AACA,UAAA,IAAA,GAAA,KAAA,UAAA,CAAA,MAAA,CAAA,CADA,CAEA;;AACA,MAAA,IAAA,CAAA,KAAA,GAAA,IAAA,CAAA,KAAA,GAAA,GAAA;AACA,MAAA,IAAA,CAAA,aAAA,GAAA,IAAA,CAAA,aAAA,GAAA,GAAA;AACA,aAAA,IAAA;AACA;AAjDA;AAhBA,CAAA","sourcesContent":["<!--\r\n * @Description: What's this for\r\n * @Autor: WangYuan\r\n * @Date: 2021-08-17 10:18:09\r\n * @LastEditors: WangYuan\r\n * @LastEditTime: 2021-12-08 20:50:34\r\n-->\r\n<template>\r\n  <div class=\"m20 p20 bg-white\">\r\n    <el-form\r\n      label-position=\"right\"\r\n      label-width=\"120px\"\r\n      :model=\"form\"\r\n      ref=\"form\"\r\n      size=\"small\"\r\n      class=\"mb50\"\r\n    >\r\n      <el-form-item label=\"商品名：\" prop=\"name\" :verify=\"{ maxLen: 30 }\">\r\n        <el-input v-model=\"form.name\" style=\"width: 500px\"></el-input>\r\n        <div class=\"f12 f-grey\">商品名称，建议30字以内</div>\r\n      </el-form-item>\r\n      <el-form-item label=\"商品描述：\" prop=\"describe\" :verify=\"{ maxLen: 60 }\">\r\n        <el-input v-model=\"form.describe\" style=\"width: 500px\"></el-input>\r\n        <div class=\"f12 f-grey\">\r\n          在商品详情页标题下面展示卖点信息，建议60字以内\r\n        </div>\r\n      </el-form-item>\r\n      <el-form-item label=\"商品封面：\" prop=\"cover\" verify>\r\n        <Imgpond v-model=\"form.cover\" :count=\"1\" />\r\n        <div class=\"f12 f-grey\">建议尺寸：800*800像素</div>\r\n      </el-form-item>\r\n      <el-form-item label=\"商品图：\" prop=\"imgList\" verify>\r\n        <Imgpond v-model=\"form.imgList\" :count=\"10\" />\r\n        <div class=\"f12 f-grey\">\r\n          建议尺寸：800*800像素，你可以拖拽图片调整顺序，最多上传10张\r\n        </div>\r\n      </el-form-item>\r\n      <el-form-item\r\n        label=\"价格：\"\r\n        prop=\"price\"\r\n        :verify=\"{ gte: 0, type: '数字' }\"\r\n      >\r\n        <el-input v-model=\"form.price\" style=\"width: 150px\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item\r\n        label=\"划线价：\"\r\n        prop=\"originalPrice\"\r\n        :verify=\"{ gte: 0, type: '数字' }\"\r\n      >\r\n        <el-input v-model=\"form.originalPrice\" style=\"width: 150px\"></el-input>\r\n      </el-form-item>\r\n      <!-- <el-form-item\r\n        label=\"库存：\"\r\n        prop=\"inventory\"\r\n        :verify=\"{gte:1,lte:10000,type:'数字'}\"\r\n      >\r\n        <el-input\r\n          v-model=\"form.inventory\"\r\n          style=\"width:150px\"\r\n        ></el-input>\r\n      </el-form-item> -->\r\n      <el-form-item label=\"商品详情：\">\r\n        <MiniMCE style=\"width: 800px\" v-model=\"form.richText\" />\r\n      </el-form-item>\r\n    </el-form>\r\n\r\n    <div class=\"operation\">\r\n      <el-button size=\"small\" class=\"f-white bg-theme\" @click=\"submit()\"\r\n        >保存商品</el-button\r\n      >\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapGetters } from \"vuex\";\r\nimport { addGoods, editGoods } from \"@/api/goods\";\r\n\r\nexport default {\r\n  created() {\r\n    let form = this.$route.params;\r\n    // 价格改为元设置\r\n    form.price = form.price ? form.price / 100 : 0;\r\n    form.originalPrice = form.originalPrice ? form.originalPrice / 100 : 0;\r\n    this.form = form;\r\n  },\r\n  data() {\r\n    return {\r\n      form: {},\r\n    };\r\n  },\r\n  computed: {\r\n    ...mapGetters([\"project\"]),\r\n  },\r\n  methods: {\r\n    // 提交\r\n    submit() {\r\n      this.$refs[\"form\"].validate((valid) => {\r\n        if (valid) {\r\n          this.form.id ? this.edit() : this.add();\r\n        }\r\n      });\r\n    },\r\n\r\n    // 新增\r\n    async add() {\r\n      let data = this.formatParams({\r\n        projectId: this.project.id,\r\n        ...this.form,\r\n      });\r\n\r\n      let { status } = await addGoods(data);\r\n\r\n      if (status == \"10000\") {\r\n        this.$notify({\r\n          title: \"成功\",\r\n          message: \"商品发布成功\",\r\n          type: \"success\",\r\n        });\r\n        this.$router.push({ name: \"goods-manager\" });\r\n      }\r\n    },\r\n\r\n    // 编辑\r\n    async edit() {\r\n      let { status } = await editGoods(this.formatParams(this.form));\r\n\r\n      if (status == \"10000\") {\r\n        this.$notify({\r\n          title: \"成功\",\r\n          message: \"商品修改成功\",\r\n          type: \"success\",\r\n        });\r\n        this.$router.push({ name: \"goods-manager\" });\r\n      }\r\n    },\r\n\r\n    formatParams(target) {\r\n      let data = this.$cloneDeep(target);\r\n      // 价格为统一为分\r\n      data.price = data.price * 100;\r\n      data.originalPrice = data.originalPrice * 100;\r\n      return data;\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.operation {\r\n  position: fixed;\r\n  bottom: 0px;\r\n  right: 20px;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  height: 60px;\r\n  width: 1612px;\r\n  box-shadow: 0 -3px 5px #eee;\r\n  background: #fff;\r\n}\r\n</style>\r\n"],"sourceRoot":"src/pages/mall/goods/goods-manager"}]}