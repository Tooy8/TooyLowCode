{"remainingRequest":"D:\\开源项目\\商城低代码\\mall-cook\\packages\\mall-cook-platform\\node_modules\\babel-loader\\lib\\index.js!D:\\开源项目\\商城低代码\\mall-cook\\packages\\mall-cook-platform\\src\\utils\\globalRegister.js","dependencies":[{"path":"D:\\开源项目\\商城低代码\\mall-cook\\packages\\mall-cook-platform\\src\\utils\\globalRegister.js","mtime":1693619752214},{"path":"D:\\开源项目\\商城低代码\\mall-cook\\packages\\mall-cook-platform\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1693619820390},{"path":"D:\\开源项目\\商城低代码\\mall-cook\\packages\\mall-cook-platform\\node_modules\\babel-loader\\lib\\index.js","mtime":1693619820336}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiRDovXHU1RjAwXHU2RTkwXHU5ODc5XHU3NkVFL1x1NTU0Nlx1NTdDRVx1NEY0RVx1NEVFM1x1NzgwMS9tYWxsLWNvb2svcGFja2FnZXMvbWFsbC1jb29rLXBsYXRmb3JtL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9vYmplY3RTcHJlYWQyIjsKaW1wb3J0IF9zbGljZWRUb0FycmF5IGZyb20gIkQ6L1x1NUYwMFx1NkU5MFx1OTg3OVx1NzZFRS9cdTU1NDZcdTU3Q0VcdTRGNEVcdTRFRTNcdTc4MDEvbWFsbC1jb29rL3BhY2thZ2VzL21hbGwtY29vay1wbGF0Zm9ybS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vc2xpY2VkVG9BcnJheSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2guanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5pdGVyYXRvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmZ1bmN0aW9uLm5hbWUuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5zcGxpdC5qcyI7CgovKg0KICogQERlc2NyaXB0aW9uOiDlhajlsYDms6jlhowNCiAqIEBBdXRvcjogV2FuZ1l1YW4NCiAqIEBEYXRlOiAyMDIxLTA2LTA0IDE2OjAwOjQ5DQogKiBATGFzdEVkaXRvcnM6IFdhbmdZdWFuDQogKiBATGFzdEVkaXRUaW1lOiAyMDIyLTAyLTA5IDIwOjQwOjI2DQogKi8KaW1wb3J0IFZ1ZSBmcm9tICd2dWUnOyAvLyDms6jlhozmiYDmnInlhajlsYDnu4Tku7YKCnJlZ2lzdGVyKHJlcXVpcmUuY29udGV4dCgnQC9jb21wb25lbnRzL2dsb2JhbCcsIHRydWUsIC8udnVlLykpOyAvLyDms6jlhozmiYDmnInphY3nva7nu4Tku7YKCnJlZ2lzdGVyKHJlcXVpcmUuY29udGV4dCgnQC9jdXN0b20tc2NoZW1hLXRlbXBsYXRlJywgdHJ1ZSwgLy52dWUvKSk7IC8vIOazqOWGjOaJgOacieeJqeaWmQovLyByZWdpc3RlcihyZXF1aXJlLmNvbnRleHQoJy4uLy4uLy4uL21hbGwtY29vay10ZW1wbGF0ZS9zcmMvd2lkZ2V0cycsIHRydWUsIC8udnVlLykpCi8vIOiOt+WPluaJgOacieeJqeaWmeWIneWni+aVsOaNruS4jnNjaGVtYeaVsOaNrgoKcmVnaXN0ZXJDb21wb25lbnRzU2NoZW1hKCk7IC8vIC8qKgovLyAgKiDms6jlhozlr7nlupTljIXkuIvmiYDmnInnu4Tku7YKLy8gICogQHBhcmFtIHsqfSBwYXRoIOWMhei3r+W+hAovLyAgKi8KCmZ1bmN0aW9uIHJlZ2lzdGVyKGNvbnRleHQpIHsKICBjb250ZXh0LmtleXMoKS5mb3JFYWNoKGZ1bmN0aW9uIChjbnQpIHsKICAgIHZhciBjb21wb25lbnQgPSBjb250ZXh0KGNudCk7CiAgICB2YXIgY3RybCA9IGNvbXBvbmVudC5kZWZhdWx0IHx8IGNvbXBvbmVudDsKICAgIHZhciBhID0gY3RybC5uYW1lOwogICAgdmFyIGIgPSBjdHJsOyAvLyDms6jlhoznu4Tku7YKCiAgICBWdWUuY29tcG9uZW50KGEsIGIpOwogIH0pOwp9IC8vIOiOt+WPluaJgOacieiHquWumuS5iee7hOS7tnNjaGVtYQoKCmZ1bmN0aW9uIHJlZ2lzdGVyQ29tcG9uZW50c1NjaGVtYSgpIHsKICB2YXIgZmlsZXMgPSByZXF1aXJlLmNvbnRleHQoJy4uLy4uLy4uL21hbGwtY29vay10ZW1wbGF0ZS9zcmMvd2lkZ2V0cycsIHRydWUsIC9jb21wb25lbnQuanNvbiQvKTsKCiAgdmFyIGZpZWxkcyA9IHt9OwogIHZhciBpbml0aWFsaXppbmcgPSB7fTsKICBmaWxlcy5rZXlzKCkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICB2YXIgX2tleSRzcGxpdCA9IGtleS5zcGxpdCgnLycpLAogICAgICAgIF9rZXkkc3BsaXQyID0gX3NsaWNlZFRvQXJyYXkoX2tleSRzcGxpdCwgMiksCiAgICAgICAgbmFtZSA9IF9rZXkkc3BsaXQyWzFdOwoKICAgIHZhciBjb25maWcgPSBfb2JqZWN0U3ByZWFkKHsKICAgICAgY29tcG9uZW50OiBuYW1lCiAgICB9LCBmaWxlcyhrZXkpKTsKCiAgICBmaWVsZHNbbmFtZV0gPSBjb25maWcuZmllbGRzOwogICAgaW5pdGlhbGl6aW5nW25hbWVdID0gaW5pdERlZmF1bFZhbHVlKGNvbmZpZyk7CiAgfSk7CiAgVnVlLnByb3RvdHlwZS4kZmllbGRzID0gZmllbGRzOwogIFZ1ZS5wcm90b3R5cGUuJGluaXRpYWxpemluZyA9IGluaXRpYWxpemluZzsKfSAvLyDliJ3lp4vljJbnu4Tku7bliJ3lp4vmlbDmja4KCgpmdW5jdGlvbiBpbml0RGVmYXVsVmFsdWUoY29uZmlnKSB7CiAgdmFyIGNvbXBvbmVudCA9IGNvbmZpZy5jb21wb25lbnQsCiAgICAgIG5hbWUgPSBjb25maWcubmFtZSwKICAgICAgaWNvbiA9IGNvbmZpZy5pY29uLAogICAgICBmaWVsZHMgPSBjb25maWcuZmllbGRzOwogIHZhciB0ZW1wID0gewogICAgY29tcG9uZW50OiBjb21wb25lbnQsCiAgICBuYW1lOiBuYW1lLAogICAgaWNvbjogaWNvbgogIH07CiAgc2V0RGVmYXVsdFZhbHVlKGZpZWxkcywgdGVtcCk7CiAgcmV0dXJuIHRlbXA7Cn0gLy8g6YCS5b2S6K6+572u5ZCE5bGC57qn5Yid5aeL5pWw5o2uCgoKZnVuY3Rpb24gc2V0RGVmYXVsdFZhbHVlKGZpZWxkcywgaW5pdGlhbGl6aW5nKSB7CiAgZm9yICh2YXIga2V5IGluIGZpZWxkcykgewogICAgdmFyIF9maWVsZHMka2V5ID0gZmllbGRzW2tleV0sCiAgICAgICAgdHlwZSA9IF9maWVsZHMka2V5LnR5cGUsCiAgICAgICAgdmFsdWUgPSBfZmllbGRzJGtleS52YWx1ZSwKICAgICAgICBjaGlsZCA9IF9maWVsZHMka2V5LmNoaWxkOwoKICAgIGlmICh0eXBlID09ICdvYmplY3QnKSB7CiAgICAgIGluaXRpYWxpemluZ1trZXldID0ge307CiAgICAgIGNoaWxkICYmIHNldERlZmF1bHRWYWx1ZShmaWVsZHNba2V5XS5jaGlsZCwgaW5pdGlhbGl6aW5nW2tleV0pOwogICAgfSBlbHNlIHsKICAgICAgaW5pdGlhbGl6aW5nW2tleV0gPSB2YWx1ZTsKICAgIH0KICB9CgogIHJldHVybiBpbml0aWFsaXppbmc7Cn0="},{"version":3,"sources":["D:/开源项目/商城低代码/mall-cook/packages/mall-cook-platform/src/utils/globalRegister.js"],"names":["Vue","register","require","context","registerComponentsSchema","keys","forEach","cnt","component","ctrl","default","a","name","b","files","fields","initializing","key","split","config","initDefaulValue","prototype","$fields","$initializing","icon","temp","setDefaultValue","type","value","child"],"mappings":"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","sourcesContent":["/*\r\n * @Description: 全局注册\r\n * @Autor: WangYuan\r\n * @Date: 2021-06-04 16:00:49\r\n * @LastEditors: WangYuan\r\n * @LastEditTime: 2022-02-09 20:40:26\r\n */\r\n\r\nimport Vue from 'vue'\r\n\r\n// 注册所有全局组件\r\nregister(require.context('@/components/global', true, /.vue/))\r\n\r\n// 注册所有配置组件\r\nregister(require.context('@/custom-schema-template', true, /.vue/))\r\n\r\n// 注册所有物料\r\n// register(require.context('../../../mall-cook-template/src/widgets', true, /.vue/))\r\n\r\n// 获取所有物料初始数据与schema数据\r\nregisterComponentsSchema()\r\n\r\n// /**\r\n//  * 注册对应包下所有组件\r\n//  * @param {*} path 包路径\r\n//  */\r\nfunction register (context) {\r\n  context.keys().forEach(cnt => {\r\n    const component = context(cnt)\r\n    let ctrl = component.default || component\r\n    let a = ctrl.name\r\n    let b = ctrl\r\n\r\n    // 注册组件\r\n    Vue.component(a, b)\r\n  })\r\n}\r\n\r\n// 获取所有自定义组件schema\r\nfunction registerComponentsSchema () {\r\n  const files = require.context('../../../mall-cook-template/src/widgets', true, /component.json$/)\r\n  let fields = {}\r\n  let initializing = {}\r\n\r\n  files.keys().forEach(key => {\r\n    const [, name] = key.split('/')\r\n    let config = { component: name, ...files(key) }\r\n\r\n    fields[name] = config.fields\r\n    initializing[name] = initDefaulValue(config)\r\n  })\r\n  Vue.prototype.$fields = fields\r\n  Vue.prototype.$initializing = initializing\r\n}\r\n\r\n// 初始化组件初始数据\r\nfunction initDefaulValue (config) {\r\n  let { component, name, icon, fields } = config\r\n  let temp = { component, name, icon }\r\n  setDefaultValue(fields, temp)\r\n  return temp\r\n}\r\n\r\n// 递归设置各层级初始数据\r\nfunction setDefaultValue (fields, initializing) {\r\n  for (let key in fields) {\r\n    let { type, value, child } = fields[key]\r\n    if (type == 'object') {\r\n      initializing[key] = {}\r\n      child && setDefaultValue(fields[key].child, initializing[key])\r\n    } else {\r\n      initializing[key] = value\r\n    }\r\n  }\r\n  return initializing\r\n}\r\n"]}]}