{"remainingRequest":"D:\\开源项目\\Tooy-LowCode\\lowCode\\node_modules\\babel-loader\\lib\\index.js!D:\\开源项目\\Tooy-LowCode\\lowCode\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!D:\\开源项目\\Tooy-LowCode\\lowCode\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\开源项目\\Tooy-LowCode\\lowCode\\src\\components\\MiniMCE\\plugins\\InsertWord\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\开源项目\\Tooy-LowCode\\lowCode\\src\\components\\MiniMCE\\plugins\\InsertWord\\index.vue","mtime":1693619752153},{"path":"D:\\开源项目\\Tooy-LowCode\\lowCode\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1693619820390},{"path":"D:\\开源项目\\Tooy-LowCode\\lowCode\\node_modules\\babel-loader\\lib\\index.js","mtime":1693619820336},{"path":"D:\\开源项目\\Tooy-LowCode\\lowCode\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1693619820390},{"path":"D:\\开源项目\\Tooy-LowCode\\lowCode\\node_modules\\vue-loader\\lib\\index.js","mtime":1693619864566}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkQ6L1x1NUYwMFx1NkU5MFx1OTg3OVx1NzZFRS9Ub295LUxvd0NvZGUvbG93Q29kZS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vYXN5bmNUb0dlbmVyYXRvciI7CmltcG9ydCAicmVnZW5lcmF0b3ItcnVudGltZS9ydW50aW1lLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZnJvbS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pdGVyYXRvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5wcm9taXNlLmFsbC1zZXR0bGVkLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5pdGVyYXRvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5Lm1hcC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5lbmRzLXdpdGguanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lLmpzIjsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IG1hbW1vdGggZnJvbSAnbWFtbW90aC9tYW1tb3RoLmJyb3dzZXIubWluLmpzJzsKZXhwb3J0IGRlZmF1bHQgewogIHByb3BzOiB7CiAgICBlZGl0b3I6IHsKICAgICAgcmVxdWlyZWQ6IHRydWUKICAgIH0KICB9LAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBzaG93OiBmYWxzZSwKICAgICAgZmlsZXM6IFtdLAogICAgICBsb2FkaW5nOiBmYWxzZSwKICAgICAgYWxsU2V0dGxlZDogdHJ1ZQogICAgfTsKICB9LAogIHdhdGNoOiB7CiAgICBzaG93OiBmdW5jdGlvbiBzaG93KG4pIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIGlmICghbikgewogICAgICAgIHRoaXMuJG5leHRUaWNrKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIF90aGlzLmZpbGVzID0gW107CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIG9wZW46IGZ1bmN0aW9uIG9wZW4oKSB7CiAgICAgIHRoaXMuc2hvdyA9IHRydWU7CiAgICB9LAogICAgb25DaGFuZ2U6IGZ1bmN0aW9uIG9uQ2hhbmdlKGZpbGUsIGZpbGVMaXN0KSB7CiAgICAgIHRoaXMuZmlsZXMgPSBBcnJheS5mcm9tKGZpbGVMaXN0LCBmdW5jdGlvbiAoX3JlZikgewogICAgICAgIHZhciByYXcgPSBfcmVmLnJhdzsKICAgICAgICByZXR1cm4gcmF3OwogICAgICB9KTsKICAgIH0sCiAgICBvblJlbW92ZTogZnVuY3Rpb24gb25SZW1vdmUoZmlsZSwgZmlsZUxpc3QpIHsKICAgICAgdGhpcy5maWxlcyA9IEFycmF5LmZyb20oZmlsZUxpc3QsIGZ1bmN0aW9uIChfcmVmMikgewogICAgICAgIHZhciByYXcgPSBfcmVmMi5yYXc7CiAgICAgICAgcmV0dXJuIHJhdzsKICAgICAgfSk7CiAgICB9LAogICAgb25TdWJtaXQ6IGZ1bmN0aW9uIG9uU3VibWl0KCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyKCkgewogICAgICAgIHZhciByZXN1bHRzOwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMiQoX2NvbnRleHQyKSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Mi5wcmV2ID0gX2NvbnRleHQyLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfdGhpczIubG9hZGluZyA9IHRydWU7CiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDM7CiAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5hbGxTZXR0bGVkKF90aGlzMi5maWxlcy5tYXAoZnVuY3Rpb24gKHYpIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgICAgICAgICAgICAgICBpZiAoIXYubmFtZS5lbmRzV2l0aCgnLmRvY3gnKSkgewogICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KCfku4XmlK/mjIEgZG9jeCDmoLzlvI8nKTsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIHZhciByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpOwoKICAgICAgICAgICAgICAgICAgICByZWFkZXIub25sb2FkID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgIHZhciBfcmVmMyA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZShlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhcnJheUJ1ZmZlcjsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFycmF5QnVmZmVyID0gZS50YXJnZXQucmVzdWx0OwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXJyYXlCdWZmZXIuYnl0ZUxlbmd0aCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFtbW90aC5jb252ZXJ0VG9IdG1sKHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJyYXlCdWZmZXI6IGFycmF5QnVmZmVyCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1lc3NhZ2VzID0gcmVzLm1lc3NhZ2VzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSByZXMudmFsdWU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCIiLmNvbmNhdCh2Lm5hbWUsICIgXHU4OUUzXHU2NzkwXHU3RUQzXHU2NzlDXHVGRjFBIiksIHJlcyk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHZhbHVlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoIiIuY29uY2F0KHYubmFtZSwgIiBcdTUxODVcdTVCQjlcdTRFM0FcdTdBN0EiKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KCIiLmNvbmNhdCh2Lm5hbWUsICIgXHU1MTg1XHU1QkI5XHU0RTNBXHU3QTdBIikpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfSwgX2NhbGxlZSk7CiAgICAgICAgICAgICAgICAgICAgICB9KSk7CgogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChfeCkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3JlZjMuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgfSgpOwoKICAgICAgICAgICAgICAgICAgICByZWFkZXIucmVhZEFzQXJyYXlCdWZmZXIodik7CiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSkpOwoKICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICByZXN1bHRzID0gX2NvbnRleHQyLnNlbnQ7CiAgICAgICAgICAgICAgICByZXN1bHRzLm1hcChmdW5jdGlvbiAocmVzdWx0KSB7CiAgICAgICAgICAgICAgICAgIHZhciBzdGF0dXMgPSByZXN1bHQuc3RhdHVzLAogICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSByZXN1bHQudmFsdWUsCiAgICAgICAgICAgICAgICAgICAgICByZWFzb24gPSByZXN1bHQucmVhc29uOwoKICAgICAgICAgICAgICAgICAgaWYgKHN0YXR1cyA9PT0gJ2Z1bGZpbGxlZCcpIHsKICAgICAgICAgICAgICAgICAgICBfdGhpczIuZWRpdG9yLmluc2VydENvbnRlbnQodmFsdWUpOwogICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGlmIChyZWFzb24pIHsKICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IocmVhc29uKTsKCiAgICAgICAgICAgICAgICAgICAgICBfdGhpczIuJG1lc3NhZ2UuZXJyb3IodHlwZW9mIHJlYXNvbiA9PT0gJ3N0cmluZycgPyByZWFzb24gOiAn6Kej5p6Q5aSx6LSlJyk7CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBfdGhpczIuYWxsU2V0dGxlZCA9IGZhbHNlOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIF90aGlzMi5maWxlcyA9IFtdOwoKICAgICAgICAgICAgICAgIF90aGlzMi4kcmVmcy5lbFVwbG9hZFJlZi5jbGVhckZpbGVzKCk7CgogICAgICAgICAgICAgICAgX3RoaXMyLmxvYWRpbmcgPSBmYWxzZTsKCiAgICAgICAgICAgICAgICBpZiAoX3RoaXMyLmFsbFNldHRsZWQpIHsKICAgICAgICAgICAgICAgICAgX3RoaXMyLnNob3cgPSBmYWxzZTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfdGhpczIuYWxsU2V0dGxlZCA9IHRydWU7CgogICAgICAgICAgICAgIGNhc2UgMTA6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTIpOwogICAgICB9KSkoKTsKICAgIH0KICB9Cn07"},{"version":3,"sources":["index.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <el-dialog\r\n    :visible=\"show\"\r\n    title=\"插入 Word 文档\"\r\n    append-to-body\r\n    destroy-on-close\r\n    :close-on-click-modal=\"false\"\r\n    @close=\"show=false\"\r\n  >\r\n    <el-upload\r\n      drag\r\n      action=\"\"\r\n      multiple\r\n      :auto-upload=\"false\"\r\n      :on-change=\"onChange\"\r\n      :on-remove=\"onRemove\"\r\n      style=\"width:100%;\"\r\n      ref=\"elUploadRef\"\r\n    >\r\n      <i class=\"el-icon-upload\"></i>\r\n      <div class=\"el-upload__text\">将 docx 文件拖到此处，或<em>点击上传</em></div>\r\n    </el-upload>\r\n\r\n    <template #footer>\r\n      <el-button @click=\"show=false\">取 消</el-button>\r\n      <el-button type=\"primary\" @click=\"onSubmit\" :loading=\"loading\" :disabled=\"!files.length\">确 定</el-button>\r\n    </template>\r\n  </el-dialog>\r\n</template>\r\n\r\n<script>\r\nimport mammoth from 'mammoth/mammoth.browser.min.js'\r\n\r\nexport default {\r\n  props: {\r\n    editor: {\r\n      required: true,\r\n    }\r\n  },\r\n  data () {\r\n    return {\r\n      show: false,\r\n      files: [],\r\n      loading: false,\r\n      allSettled: true,\r\n    }\r\n  },\r\n  watch: {\r\n    show (n) {\r\n      if (!n) {\r\n        this.$nextTick(() => {\r\n          this.files = []\r\n        })\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    open () {\r\n      this.show = true\r\n    },\r\n    onChange (file, fileList) {\r\n      this.files = Array.from(fileList, ({ raw }) => raw)\r\n    },\r\n    onRemove (file, fileList) {\r\n      this.files = Array.from(fileList, ({ raw }) => raw)\r\n    },\r\n    async onSubmit () {\r\n      this.loading = true\r\n      const results = await Promise.allSettled(this.files.map(v =>\r\n        new Promise((resolve, reject) => {\r\n          if (!v.name.endsWith('.docx')) {\r\n            reject('仅支持 docx 格式')\r\n          }\r\n\r\n          const reader = new FileReader()\r\n          reader.onload = async e => {\r\n            const arrayBuffer = e.target.result\r\n            if (arrayBuffer.byteLength) {\r\n              mammoth.convertToHtml({ arrayBuffer }).then(res => {\r\n                const { messages, value } = res\r\n                console.log(`${v.name} 解析结果：`, res)\r\n                if (value) {\r\n                  resolve(value)\r\n                } else {\r\n                  reject(`${v.name} 内容为空`)\r\n                }\r\n              }).catch(err => {\r\n                reject(err)\r\n              })\r\n            } else {\r\n              reject(`${v.name} 内容为空`)\r\n            }\r\n          }\r\n          reader.readAsArrayBuffer(v)\r\n        })\r\n      ))\r\n\r\n      results.map(result => {\r\n        const { status, value, reason } = result\r\n        if (status === 'fulfilled') {\r\n          this.editor.insertContent(value)\r\n        } else {\r\n          if (reason) {\r\n            console.error(reason)\r\n            this.$message.error(typeof reason === 'string' ? reason : '解析失败')\r\n          }\r\n          this.allSettled = false\r\n        }\r\n      })\r\n\r\n      this.files = []\r\n      this.$refs.elUploadRef.clearFiles()\r\n      this.loading = false\r\n      if (this.allSettled) {\r\n        this.show = false\r\n      }\r\n      this.allSettled = true\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n::v-deep .el-dialog {\r\n  min-width: 600px;\r\n\r\n  & > .el-dialog__body {\r\n    display: flex;\r\n    justify-content: center;\r\n\r\n    .el-upload {\r\n      width: 100%;\r\n\r\n      & > .el-upload-dragger {\r\n        width: 100%;\r\n\r\n        .el-upload__text {\r\n          display: block !important;\r\n        }\r\n      }\r\n    }\r\n\r\n    .el-upload-list__item {\r\n      width: initial !important;\r\n      height: initial !important;\r\n    }\r\n  }\r\n}\r\n</style>\r\n"],"sourceRoot":"src/components/MiniMCE/plugins/InsertWord"}]}