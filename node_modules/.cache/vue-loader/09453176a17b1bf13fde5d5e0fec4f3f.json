{"remainingRequest":"D:\\开源项目\\低代码\\Tooy-LowCode\\lowCode\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\开源项目\\低代码\\Tooy-LowCode\\lowCode\\src\\components\\ModelsList\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\开源项目\\低代码\\Tooy-LowCode\\lowCode\\src\\components\\ModelsList\\index.vue","mtime":1694430222335},{"path":"D:\\开源项目\\低代码\\Tooy-LowCode\\lowCode\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1693619820390},{"path":"D:\\开源项目\\低代码\\Tooy-LowCode\\lowCode\\node_modules\\babel-loader\\lib\\index.js","mtime":1693619820336},{"path":"D:\\开源项目\\低代码\\Tooy-LowCode\\lowCode\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1693619820390},{"path":"D:\\开源项目\\低代码\\Tooy-LowCode\\lowCode\\node_modules\\vue-loader\\lib\\index.js","mtime":1693619864566}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgeyBtYXBHZXR0ZXJzLCBtYXBNdXRhdGlvbnMgfSBmcm9tICJ2dWV4IjsNCmltcG9ydCB7IGdldE1vZGVsTGlzdCwgZ2V0UHJvamVjdEJ5SWQgfSBmcm9tICJAL2FwaS9wcm9qZWN0IjsNCmltcG9ydCB7IG1hbGxJbmR1c3RyeUxpc3QsIG1hbGxUeXBlTGlzdCB9IGZyb20gIkAvY29uZmlnL21hbGwiOw0KaW1wb3J0IGdsb2JhbCBmcm9tICJAL2NvbmZpZy9nbG9iYWwiOw0KDQpleHBvcnQgZGVmYXVsdCB7DQogIGNyZWF0ZWQoKSB7DQogICAgdGhpcy5nZXRsSW5kdXN0cnlOYW1lKCk7DQogIH0sDQoNCiAgZGF0YSgpIHsNCiAgICByZXR1cm4gew0KICAgICAgbG9hZGluZzogZmFsc2UsDQogICAgICBpbmR1c3RyeTogIiIsDQogICAgICBsaXN0OiBbXSwNCiAgICAgIGluZHVzdHJ5TGlzdDogW3sgbGFiZWw6ICLlhajpg6giLCB2YWx1ZTogIiIgfSwgLi4ubWFsbEluZHVzdHJ5TGlzdF0sDQogICAgICBwYWdpbmF0aW9uRm9ybTogew0KICAgICAgICBwYWdlOiAxLA0KICAgICAgICB0b3RhbDogMCwNCiAgICAgICAgcGFnZVNpemU6IDEwDQogICAgICB9DQogICAgfTsNCiAgfSwNCg0KICBjb21wdXRlZDogew0KICAgIC4uLm1hcEdldHRlcnMoWyJwcm9qZWN0IiwgInVzZXJJbmZvIl0pLA0KICB9LA0KDQogIHdhdGNoOiB7DQogICAgaW5kdXN0cnk6IHsNCiAgICAgIGltbWVkaWF0ZTogdHJ1ZSwNCiAgICAgIGhhbmRsZXIoKSB7DQogICAgICAgIHRoaXMuZ2V0TW9kZWxMaXN0KCk7DQogICAgICB9LA0KICAgIH0sDQogIH0sDQoNCiAgbWV0aG9kczogew0KICAgIC4uLm1hcE11dGF0aW9ucyhbInNldFByb2plY3QiXSksDQoNCiAgICAvLyDmqKHmnb/llYbln47mmoLml7blj6rlsZXnpLroh6rlt7HnmoQNCiAgICBhc3luYyBnZXRNb2RlbExpc3QoKSB7DQogICAgICB0aGlzLmxvYWRpbmcgPSB0cnVlOw0KICAgICAgbGV0IHsgbGlzdCwgdG90YWxDb3VudCB9ID0gYXdhaXQgZ2V0TW9kZWxMaXN0KHsNCiAgICAgICAgaW5kdXN0cnk6IHRoaXMuaW5kdXN0cnksDQogICAgICAgIHBhZ2luYXRpb246IHRoaXMucGFnaW5hdGlvbkZvcm0sDQogICAgICB9KTsNCiAgICAgIHRoaXMubGlzdCA9IGxpc3Q7DQogICAgICB0aGlzLiRzZXQodGhpcy5wYWdpbmF0aW9uRm9ybSwgInRvdGFsIiwgdG90YWxDb3VudCk7DQogICAgICAvLyB0aGlzLmxpc3QgPSBsaXN0LmZpbHRlcigNCiAgICAgIC8vICAgKGl0ZW0pID0+IGl0ZW0udXNlcklkID09ICI2MThkMTQxODQ4ZjI1MTQ5MDRlYmQwN2UiDQogICAgICAvLyApOw0KICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7DQogICAgfSwNCg0KICAgIGdldGxJbmR1c3RyeU5hbWUodGFyZ2V0KSB7DQogICAgICBsZXQgaW5kdXN0cnlNYXAgPSBtYWxsSW5kdXN0cnlMaXN0LnJlZHVjZSgocHJlLCBjdXIpID0+IHsNCiAgICAgICAgcHJlLnNldChjdXIudmFsdWUsIGN1ci5sYWJlbCk7DQogICAgICAgIHJldHVybiBwcmU7DQogICAgICB9LCBuZXcgTWFwKCkpOw0KDQogICAgICByZXR1cm4gaW5kdXN0cnlNYXAuZ2V0KHRhcmdldCk7DQogICAgfSwNCg0KICAgIGFzeW5jIHVzZU1vZGVsKG1vZGVsKSB7DQogICAgICBsZXQgeyBkYXRhIH0gPSBhd2FpdCBnZXRQcm9qZWN0QnlJZCh7IGlkOiBtb2RlbC5pZCB9KQ0KICAgICAgbGV0IHsgX2lkLCBpZCwgbmFtZSwgdXNlcklkIH0gPSB0aGlzLnByb2plY3Q7DQoNCiAgICAgIGxldCBtYXAgPSBuZXcgTWFwKCk7DQogICAgICBtYWxsVHlwZUxpc3QubWFwKChpdGVtKSA9PiBtYXAuc2V0KGl0ZW0udHlwZSwgaXRlbS5sb2dvKSk7DQoNCiAgICAgIC8vIOaooeadv+S4iumFjee9ruebuOWFs+WVhuWfjuaVsOaNrg0KICAgICAgbGV0IG1hbGwgPSB7DQogICAgICAgIC4uLnRoaXMuJGNsb25lRGVlcChkYXRhKSwNCiAgICAgICAgLi4ueyBfaWQsIGlkLCBuYW1lLCB1c2VySWQsIHR5cGU6ICJtYWxsIiwgbG9nbzogbWFwLmdldCgibWFsbCIpIH0sDQogICAgICB9Ow0KDQogICAgICB0aGlzLnNldFByb2plY3QobWFsbCk7DQogICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7IG5hbWU6ICJwYWdlLWJ1aWxkIiB9KTsNCg0KICAgICAgdGhpcy4kbWVzc2FnZSh7DQogICAgICAgIHR5cGU6ICJzdWNjZXNzIiwNCiAgICAgICAgbWVzc2FnZTogIuW3suS9v+eUqOmAieS4reaooeadvyEiLA0KICAgICAgfSk7DQogICAgfSwNCg0KICAgIGdldFFyKGlkKSB7DQogICAgICBsZXQgdXJsID0gYCR7Z2xvYmFsLnZpZXdVcmx9cGFnZXMvaW5kZXgvdGFiYmFyL2hvbWU/aWQ9JHtpZH1gOw0KDQogICAgICBsZXQgb3B0aW9ucyA9IHsNCiAgICAgICAgcGFkZGluZzogMCwgLy8g5LqM57u056CB5Zub6L6556m655m977yI6buY6K6k5Li6MTBweO+8iQ0KICAgICAgICB3aWR0aDogMTgwLCAvLyDkuoznu7TnoIHlm77niYflrr3luqbvvIjpu5jorqTkuLoyNTZweO+8iQ0KICAgICAgICBoZWlnaHQ6IDE4MCwgLy8g5LqM57u056CB5Zu+54mH6auY5bqm77yI6buY6K6k5Li6MjU2cHjvvIkNCiAgICAgICAgcmV2ZXJzZTogZmFsc2UsIC8vIOWPjeiJsuS6jOe7tOegge+8jOS6jOe7tOeggeminOiJsuS4uuS4iuWxguWuueWZqOeahOiDjOaZr+minOiJsg0KICAgICAgICBiYWNrZ3JvdW5kOiAiI2ZmZmZmZiIsIC8vIOS6jOe7tOeggeiDjOaZr+minOiJsu+8iOm7mOiupOeZveiJsu+8iQ0KICAgICAgICBmb3JlZ3JvdW5kOiAiIzAwMDAwMCIsIC8vIOS6jOe7tOeggeminOiJsu+8iOm7mOiupOm7keiJsu+8iQ0KICAgICAgfTsNCiAgICAgIGNvbnNvbGUubG9nKCLpooTop4jlnLDlnYAxOiIgKyB1cmwpOw0KICAgICAgcmV0dXJuIGpyUXJjb2RlLmdldFFyQmFzZTY0KHVybCwgb3B0aW9ucyk7DQogICAgfSwNCg0KICAgIGhhbmRsZUN1cnJlbnRDaGFuZ2UocCkgew0KICAgICAgdGhpcy4kc2V0KHRoaXMucGFnaW5hdGlvbkZvcm0sICJwYWdlIiwgcCk7DQogICAgICB0aGlzLmdldE1vZGVsTGlzdCgpOw0KICAgIH0sDQogIH0sDQp9Ow0K"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4DA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/components/ModelsList","sourcesContent":["<!--\r\n * @Description: 模板商城\r\n\r\n-->\r\n<template>\r\n  <div>\r\n    <div class=\"wrap\">\r\n      <!-- 行业分类 -->\r\n      <ul class=\"wrap-head\">\r\n        <li v-for=\"(item, index) in industryList\" :key=\"index\" class=\"wrap-head-item\"\r\n          :class=\"[item.value == industry ? 'wrap-head-active' : '']\" @click=\"industry = item.value\">\r\n          {{ item.label }}\r\n        </li>\r\n      </ul>\r\n      <!-- 模板列表 -->\r\n      <div v-loading=\"loading\">\r\n        <ul v-if=\"list.length\" class=\"wrap-list\">\r\n          <li v-for=\"model in list\" :key=\"model.id\" class=\"model\">\r\n            <template>\r\n              <img class=\"model-img\" :src=\"model.cover\" />\r\n              <div class=\"model-desc\">\r\n                <h3 class=\"mt5 f14\">{{ model.name }}</h3>\r\n                <!-- <div class=\"mt10 f12 f-grey\">设计师：{{ userInfo.userName }}</div> -->\r\n                <el-tag effect=\"plain\" size=\"mini\" class=\"mt5\">{{\r\n                  getlIndustryName(model.industry)\r\n                }}</el-tag>\r\n              </div>\r\n            </template>\r\n\r\n            <template>\r\n              <div class=\"model-qr\">\r\n                <img class=\"w90 mb5\" :src=\"getQr(model.id)\" />\r\n                <span>扫码预览</span>\r\n              </div>\r\n\r\n              <span class=\"model-btn\" @click=\"useModel(model)\">使用模板</span>\r\n            </template>\r\n          </li>\r\n\r\n          <li style=\"text-align: center;margin-top: 20px;\">\r\n            <el-pagination background :page-size=\"paginationForm.pageSize\" layout=\"total, prev, pager, next\"\r\n              :total=\"paginationForm.total\" @current-change=\"handleCurrentChange\" />\r\n          </li>\r\n        </ul>\r\n\r\n        <!-- 空列表 -->\r\n        <el-empty v-else class=\"mt80\">\r\n          <template slot=\"description\">\r\n            <span class=\"f13 f-grey\">{{ `没有此类型模板哦` }}</span>\r\n          </template>\r\n        </el-empty>\r\n      </div>\r\n\r\n    </div>\r\n\r\n\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapGetters, mapMutations } from \"vuex\";\r\nimport { getModelList, getProjectById } from \"@/api/project\";\r\nimport { mallIndustryList, mallTypeList } from \"@/config/mall\";\r\nimport global from \"@/config/global\";\r\n\r\nexport default {\r\n  created() {\r\n    this.getlIndustryName();\r\n  },\r\n\r\n  data() {\r\n    return {\r\n      loading: false,\r\n      industry: \"\",\r\n      list: [],\r\n      industryList: [{ label: \"全部\", value: \"\" }, ...mallIndustryList],\r\n      paginationForm: {\r\n        page: 1,\r\n        total: 0,\r\n        pageSize: 10\r\n      }\r\n    };\r\n  },\r\n\r\n  computed: {\r\n    ...mapGetters([\"project\", \"userInfo\"]),\r\n  },\r\n\r\n  watch: {\r\n    industry: {\r\n      immediate: true,\r\n      handler() {\r\n        this.getModelList();\r\n      },\r\n    },\r\n  },\r\n\r\n  methods: {\r\n    ...mapMutations([\"setProject\"]),\r\n\r\n    // 模板商城暂时只展示自己的\r\n    async getModelList() {\r\n      this.loading = true;\r\n      let { list, totalCount } = await getModelList({\r\n        industry: this.industry,\r\n        pagination: this.paginationForm,\r\n      });\r\n      this.list = list;\r\n      this.$set(this.paginationForm, \"total\", totalCount);\r\n      // this.list = list.filter(\r\n      //   (item) => item.userId == \"618d141848f2514904ebd07e\"\r\n      // );\r\n      this.loading = false;\r\n    },\r\n\r\n    getlIndustryName(target) {\r\n      let industryMap = mallIndustryList.reduce((pre, cur) => {\r\n        pre.set(cur.value, cur.label);\r\n        return pre;\r\n      }, new Map());\r\n\r\n      return industryMap.get(target);\r\n    },\r\n\r\n    async useModel(model) {\r\n      let { data } = await getProjectById({ id: model.id })\r\n      let { _id, id, name, userId } = this.project;\r\n\r\n      let map = new Map();\r\n      mallTypeList.map((item) => map.set(item.type, item.logo));\r\n\r\n      // 模板上配置相关商城数据\r\n      let mall = {\r\n        ...this.$cloneDeep(data),\r\n        ...{ _id, id, name, userId, type: \"mall\", logo: map.get(\"mall\") },\r\n      };\r\n\r\n      this.setProject(mall);\r\n      this.$router.push({ name: \"page-build\" });\r\n\r\n      this.$message({\r\n        type: \"success\",\r\n        message: \"已使用选中模板!\",\r\n      });\r\n    },\r\n\r\n    getQr(id) {\r\n      let url = `${global.viewUrl}pages/index/tabbar/home?id=${id}`;\r\n\r\n      let options = {\r\n        padding: 0, // 二维码四边空白（默认为10px）\r\n        width: 180, // 二维码图片宽度（默认为256px）\r\n        height: 180, // 二维码图片高度（默认为256px）\r\n        reverse: false, // 反色二维码，二维码颜色为上层容器的背景颜色\r\n        background: \"#ffffff\", // 二维码背景颜色（默认白色）\r\n        foreground: \"#000000\", // 二维码颜色（默认黑色）\r\n      };\r\n      console.log(\"预览地址1:\" + url);\r\n      return jrQrcode.getQrBase64(url, options);\r\n    },\r\n\r\n    handleCurrentChange(p) {\r\n      this.$set(this.paginationForm, \"page\", p);\r\n      this.getModelList();\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n::v-deep .el-button {\r\n  background: $color-theme;\r\n}\r\n\r\n.el-tag {\r\n  color: $color-theme;\r\n  border-color: $color-theme;\r\n}\r\n\r\n.wrap {\r\n  margin-top: 20px;\r\n\r\n  .wrap-head {\r\n    display: flex;\r\n    margin-bottom: 10px;\r\n\r\n    .wrap-head-item {\r\n      padding: 8px 12px;\r\n      margin: 0 8px 8px 0;\r\n      background: #f2f2f6;\r\n      border-radius: 4px;\r\n      font-size: 12px;\r\n      text-align: center;\r\n      cursor: pointer;\r\n    }\r\n\r\n    .wrap-head-active {\r\n      color: $color-theme;\r\n      background: rgba(37, 137, 255, 0.1);\r\n    }\r\n  }\r\n\r\n  .wrap-list {\r\n    height: 75vh;\r\n    overflow: auto;\r\n\r\n    .model {\r\n      position: relative;\r\n      display: inline-block;\r\n      width: 220px;\r\n      max-height: 380px;\r\n      margin: 0 20px 20px 0;\r\n      border: 1px solid #e9e9e9;\r\n      border-radius: 4px;\r\n      overflow: hidden;\r\n      cursor: pointer;\r\n\r\n      .model-img {\r\n        width: 100%;\r\n        min-height: 400px;\r\n      }\r\n\r\n      .model-desc {\r\n        position: absolute;\r\n        left: 0;\r\n        bottom: -30px;\r\n        width: 100%;\r\n        height: 90px;\r\n        padding: 10px;\r\n        background: hsla(0, 0%, 100%, 0.95);\r\n        font-size: 12px;\r\n        color: #333;\r\n        transition: all 0.3s;\r\n        z-index: 10;\r\n      }\r\n\r\n      .model-qr {\r\n        display: none;\r\n        position: absolute;\r\n        top: 20%;\r\n        left: 50%;\r\n        width: 110px;\r\n        padding: 10px;\r\n        border-radius: 6px;\r\n        transform: translateX(-50%);\r\n        background: #fff;\r\n        font-size: 12px;\r\n        text-align: center;\r\n        color: #595961;\r\n        z-index: 10;\r\n      }\r\n\r\n      .model-btn {\r\n        display: none;\r\n        position: absolute;\r\n        top: 56%;\r\n        left: 50%;\r\n        width: 110px;\r\n        height: 28px;\r\n        line-height: 28px;\r\n        border-radius: 4px;\r\n        transform: translateX(-50%);\r\n        background: $color-theme;\r\n        font-size: 12px;\r\n        color: #fff;\r\n        text-align: center;\r\n        z-index: 10;\r\n      }\r\n\r\n      &:hover {\r\n        &::after {\r\n          content: \"\";\r\n          position: absolute;\r\n          top: 0;\r\n          left: 0;\r\n          width: 100%;\r\n          height: 100%;\r\n          background: #68656530;\r\n          z-index: 1;\r\n          transition: all 0.3s;\r\n        }\r\n\r\n        .model-desc {\r\n          bottom: 0px;\r\n        }\r\n\r\n        .model-btn,\r\n        .model-qr {\r\n          display: inline-block;\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>"]}]}