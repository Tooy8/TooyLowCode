{"remainingRequest":"D:\\开源项目\\商城低代码\\mall-cook\\packages\\mall-cook-platform\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\开源项目\\商城低代码\\mall-cook\\packages\\mall-cook-platform\\src\\custom-schema-template\\components\\SchemaCapCube\\CapCubeLayout.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\开源项目\\商城低代码\\mall-cook\\packages\\mall-cook-platform\\src\\custom-schema-template\\components\\SchemaCapCube\\CapCubeLayout.vue","mtime":1693619752169},{"path":"D:\\开源项目\\商城低代码\\mall-cook\\packages\\mall-cook-platform\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1693619820390},{"path":"D:\\开源项目\\商城低代码\\mall-cook\\packages\\mall-cook-platform\\node_modules\\babel-loader\\lib\\index.js","mtime":1693619820336},{"path":"D:\\开源项目\\商城低代码\\mall-cook\\packages\\mall-cook-platform\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1693619820390},{"path":"D:\\开源项目\\商城低代码\\mall-cook\\packages\\mall-cook-platform\\node_modules\\vue-loader\\lib\\index.js","mtime":1693619864566}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQpleHBvcnQgZGVmYXVsdCB7DQogIG5hbWU6ICJjdXN0b20tbGF5b3V0IiwNCiAgcHJvcHM6IHsNCiAgICB2YWx1ZTogew0KICAgICAgdHlwZTogQXJyYXksDQogICAgICBkZWZhdWx0OiAoKSA9PiBbXSwNCiAgICB9LA0KICAgIG1vZGVsOiB7DQogICAgICB0eXBlOiBTdHJpbmcsDQogICAgICBkZWZhdWx0OiAiY3VzdG9tIiwNCiAgICB9LA0KICAgIHJvdzogew0KICAgICAgdHlwZTogTnVtYmVyLA0KICAgICAgZGVmYXVsdDogMTAsDQogICAgfSwNCiAgfSwNCiAgZGF0YSgpIHsNCiAgICByZXR1cm4gew0KICAgICAgc3RhcnRLZXk6IDAsDQogICAgICBjdXVySW5kZXg6IC0xLA0KICAgICAgY29sOiA2LA0KICAgICAgZWRpdDogZmFsc2UsIC8vIOe8lui+keaooeW8jw0KICAgICAgeXM6IFtdLA0KICAgICAgbVZhbHVlOiBbXSwNCiAgICAgIGVkaXRLZXlzOiBbXSwgLy8g57yW6L6Ra2V56ZuG5ZCIDQogICAgfTsNCiAgfSwNCiAgY29tcHV0ZWQ6IHsNCiAgICB4cygpIHsNCiAgICAgIHJldHVybiBbLi4uQXJyYXkodGhpcy5jb2wpLmtleXMoKV07DQogICAgfSwNCiAgfSwNCiAgd2F0Y2g6IHsNCiAgICB2YWx1ZTogew0KICAgICAgaW1tZWRpYXRlOiB0cnVlLA0KICAgICAgZGVlcDogdHJ1ZSwNCiAgICAgIGhhbmRsZXIobmV3VmFsdWUsIG9sZFZhbHVlKSB7DQogICAgICAgIHRoaXMubVZhbHVlID0gbmV3VmFsdWU7DQogICAgICB9LA0KICAgIH0sDQogICAgbVZhbHVlOiB7DQogICAgICBpbW1lZGlhdGU6IHRydWUsDQogICAgICBkZWVwOiB0cnVlLA0KICAgICAgaGFuZGxlcihuZXdWYWx1ZSwgb2xkVmFsdWUpIHsNCiAgICAgICAgdGhpcy4kZW1pdCgiaW5wdXQiLCBuZXdWYWx1ZSk7DQogICAgICB9LA0KICAgIH0sDQogICAgcm93OiB7DQogICAgICBpbW1lZGlhdGU6IHRydWUsDQogICAgICBoYW5kbGVyKG5ld1ZhbHVlLCBvbGRWYWx1ZSkgew0KICAgICAgICB0aGlzLnlzID0gWy4uLkFycmF5KHRoaXMucm93KS5rZXlzKCldOw0KICAgICAgfSwNCiAgICB9LA0KICAgIGN1dXJJbmRleDogew0KICAgICAgaGFuZGxlcihuZXdWYWx1ZSwgb2xkVmFsdWUpIHsNCiAgICAgICAgY29uc29sZS5sb2coJy4uLicpOw0KICAgICAgICANCiAgICAgICAgY29uc29sZS5sb2cobmV3VmFsdWUpOw0KICAgICAgICANCiAgICAgICAgbGV0IHRlbXAgPSBuZXdWYWx1ZSA9PSAtMSA/IHVuZGVmaW5lZCA6IHRoaXMubVZhbHVlW25ld1ZhbHVlXTsNCiAgICAgICAgdGhpcy4kZW1pdCgib25DdXVySW5kZXgiLCB0ZW1wKTsNCiAgICAgIH0sDQogICAgfSwNCiAgfSwNCiAgbWV0aG9kczogew0KICAgIC8vIOmHjee9ruWuueWZqA0KICAgIHJlc2V0KCkgew0KICAgICAgdGhpcy5zdGFydEtleSA9IDA7DQogICAgICB0aGlzLmN1dXJJbmRleCA9IC0xOw0KICAgICAgdGhpcy5lZGl0ID0gZmFsc2U7DQogICAgICB0aGlzLm1WYWx1ZSA9IFtdOw0KICAgICAgdGhpcy5lZGl0S2V5cyA9IFtdOw0KICAgIH0sDQoNCiAgICAvLyDngrnlh7vljZXlhYPlnZcNCiAgICBjbGlja1dyYXAoZSkgew0KICAgICAgLy8g5byA5aeL57yW6L6R5qih5byPDQogICAgICBpZiAoIXRoaXMuZWRpdCkgew0KICAgICAgICBsZXQga2V5ID0gZS50YXJnZXQuZGF0YXNldC5rZXk7DQogICAgICAgIHRoaXMuZWRpdEtleXMucHVzaChOdW1iZXIoa2V5KSk7DQogICAgICAgIHRoaXMuc3RhcnRLZXkgPSBrZXk7DQogICAgICAgIHRoaXMuZWRpdCA9IHRydWU7DQogICAgICB9IGVsc2Ugew0KICAgICAgICBsZXQga2V5cyA9IHRoaXMuJGNsb25lRGVlcCh0aGlzLl8uc29ydEJ5KHRoaXMuZWRpdEtleXMpKTsNCiAgICAgICAgbGV0IHN0YXJ0ID0gdGhpcy5zcGxpdEtleShrZXlzWzBdKTsNCiAgICAgICAgbGV0IGVuZCA9IHRoaXMuc3BsaXRLZXkoa2V5cy5wb3AoKSk7DQoNCiAgICAgICAgLy8g57uT5p2f57yW6L6R5qih5byPDQogICAgICAgIGxldCB0ZW1wID0gew0KICAgICAgICAgIHRvcDogc3RhcnQueSwNCiAgICAgICAgICBsZWZ0OiBzdGFydC54LA0KICAgICAgICAgIGJvdHRvbTogZW5kLnkgKyAxLA0KICAgICAgICAgIHJpZ2h0OiBlbmQueCArIDEsDQogICAgICAgICAgaGVpZ2h0OiBlbmQueSAtIHN0YXJ0LnkgKyAxLA0KICAgICAgICAgIHdpZHRoOiBlbmQueCAtIHN0YXJ0LnggKyAxLA0KICAgICAgICAgIGltYWdlOiAiLy9kMzAzLnBhaXhpbi5jb20vdGh1bWJzLzE1NjEzNTkvMzc4NDY3MzM4L3N0YWZmXzEwMjQuanBnIiwNCiAgICAgICAgfTsNCg0KICAgICAgICB0aGlzLm1WYWx1ZS5wdXNoKHRlbXApOw0KICAgICAgICB0aGlzLmN1dXJJbmRleCA9IHRoaXMubVZhbHVlLmxlbmd0aCAtIDE7DQoNCiAgICAgICAgdGhpcy5lZGl0S2V5cyA9IFtdOw0KICAgICAgICB0aGlzLmVkaXQgPSBmYWxzZTsNCiAgICAgIH0NCiAgICB9LA0KDQogICAgLy8g56e75Yqo6byg5qCH6K6+572u57yW6L6R5a655ZmoDQogICAgbW92ZShlKSB7DQogICAgICBpZiAoIXRoaXMuZWRpdCkgcmV0dXJuOw0KDQogICAgICBsZXQga2V5cyA9IFtdOw0KICAgICAgbGV0IHN0YXJ0ID0gdGhpcy5zcGxpdEtleSh0aGlzLnN0YXJ0S2V5KTsNCiAgICAgIGxldCBlbmQgPSB0aGlzLnNwbGl0S2V5KGUudGFyZ2V0LmRhdGFzZXQua2V5KTsNCiAgICAgIGxldCB5cyA9IHRoaXMuXy5zb3J0QnkoW3N0YXJ0LnksIGVuZC55XSk7DQogICAgICBsZXQgeHMgPSB0aGlzLl8uc29ydEJ5KFtzdGFydC54LCBlbmQueF0pOw0KDQogICAgICAvLyDlrrnlmajnorDmkp7vvIzpmLvmraLnvJbovpHlrrnlmajlj5jmm7QNCiAgICAgIGlmICh0aGlzLmFudGlDb2xsaXNpb24oc3RhcnQsIGVuZCkpIHsNCiAgICAgICAgcmV0dXJuOw0KICAgICAgfQ0KDQogICAgICBmb3IgKGxldCBpID0geXNbMF07IGkgPD0geXNbMV07IGkrKykgew0KICAgICAgICBmb3IgKGxldCBqID0geHNbMF07IGogPD0geHNbMV07IGorKykgew0KICAgICAgICAgIGtleXMucHVzaCh0aGlzLm1lcmdlS2V5KGksIGopKTsNCiAgICAgICAgfQ0KICAgICAgfQ0KDQogICAgICB0aGlzLmVkaXRLZXlzID0ga2V5czsNCiAgICB9LA0KDQogICAgLy8g6Ziy56Kw5pKe566X5rOVDQogICAgYW50aUNvbGxpc2lvbihzdGFydCwgZW5kKSB7DQogICAgICBsZXQgcmVzdWx0ID0gZmFsc2U7DQoNCiAgICAgIHRoaXMuJGNsb25lRGVlcCh0aGlzLm1WYWx1ZSkubWFwKChpdGVtKSA9PiB7DQogICAgICAgIC0taXRlbS5ib3R0b207DQogICAgICAgIC0taXRlbS5yaWdodDsNCg0KICAgICAgICAvLyDliKTmlq0geCDmmK/lkKbmnInkuqTpm4YNCiAgICAgICAgaWYgKA0KICAgICAgICAgIHRoaXMuJGlzSW50ZXJzZWN0aW9uKHRoaXMuXy5zb3J0QnkoW3N0YXJ0LngsIGVuZC54XSksIFsNCiAgICAgICAgICAgIGl0ZW0ubGVmdCwNCiAgICAgICAgICAgIGl0ZW0ucmlnaHQsDQogICAgICAgICAgXSkNCiAgICAgICAgKSB7DQogICAgICAgICAgLy8g5Yid5aeL54K55Zyo55uu5qCH5Z2Xeei9tOS4iuaWuSznu5PmnZ/ngrnlpKfkuo7nrYnkuo7nm67moIflnZd0b3DvvIzlj5HnlJ/kuobnorDmkp4NCiAgICAgICAgICBpZiAoc3RhcnQueSA8IGl0ZW0udG9wICYmIGVuZC55ID49IGl0ZW0udG9wKSB7DQogICAgICAgICAgICBjb25zb2xlLmxvZygi5Yid5aeL54K55Zyo55uu5qCH5Z2Xeei9tOS4iuaWuSznorDmkp7kuoYiKTsNCiAgICAgICAgICAgIHJlc3VsdCA9IHRydWU7DQogICAgICAgICAgfQ0KICAgICAgICAgIC8vIOWIneWni+eCueWcqOebruagh+Wdl3novbTkuIvmlrks57uT5p2f54K55bCP5LqO562J5LqO55uu5qCH5Z2XYm90dG9t77yM5Y+R55Sf5LqG56Kw5pKeDQogICAgICAgICAgaWYgKHN0YXJ0LnkgPiBpdGVtLmJvdHRvbSAmJiBlbmQueSA8PSBpdGVtLmJvdHRvbSkgew0KICAgICAgICAgICAgY29uc29sZS5sb2coIuWIneWni+eCueWcqOebruagh+Wdl3novbTkuIvmlrks56Kw5pKe5LqGIik7DQogICAgICAgICAgICByZXN1bHQgPSB0cnVlOw0KICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIC8vIOWIpOaWrSB5IOaYr+WQpuacieS6pOmbhg0KICAgICAgICBpZiAoDQogICAgICAgICAgdGhpcy4kaXNJbnRlcnNlY3Rpb24odGhpcy5fLnNvcnRCeShbc3RhcnQueSwgZW5kLnldKSwgWw0KICAgICAgICAgICAgaXRlbS50b3AsDQogICAgICAgICAgICBpdGVtLmJvdHRvbSwNCiAgICAgICAgICBdKQ0KICAgICAgICApIHsNCiAgICAgICAgICAvLyDliJ3lp4vngrnlnKjnm67moIflnZd56L205bem5pa5LOe7k+adn+eCueWkp+S6juetieS6juebruagh+Wdl2xlZnTvvIzlj5HnlJ/kuobnorDmkp4NCiAgICAgICAgICBpZiAoc3RhcnQueCA8IGl0ZW0ubGVmdCAmJiBlbmQueCA+PSBpdGVtLmxlZnQpIHsNCiAgICAgICAgICAgIGNvbnNvbGUubG9nKCLliJ3lp4vngrnlnKjnm67moIflnZd56L205bem5pa5LOeisOaSnuS6hiIpOw0KICAgICAgICAgICAgcmVzdWx0ID0gdHJ1ZTsNCiAgICAgICAgICB9DQogICAgICAgICAgLy8g5Yid5aeL54K55Zyo55uu5qCH5Z2Xeei9tOS4i+aWuSznu5PmnZ/ngrnlsI/kuo7nrYnkuo7nm67moIflnZdib3R0b23vvIzlj5HnlJ/kuobnorDmkp4NCiAgICAgICAgICBpZiAoc3RhcnQueCA+IGl0ZW0ucmlnaHQgJiYgZW5kLnggPD0gaXRlbS5yaWdodCkgew0KICAgICAgICAgICAgY29uc29sZS5sb2coIuWIneWni+eCueWcqOebruagh+Wdl3novbTlj7Pmlrks56Kw5pKe5LqGIik7DQogICAgICAgICAgICByZXN1bHQgPSB0cnVlOw0KICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgfSk7DQoNCiAgICAgIHJldHVybiByZXN1bHQ7DQogICAgfSwNCg0KICAgIC8vIOWdkOagh+iuoeeul+S4i+aghw0KICAgIG1lcmdlS2V5KHksIHgpIHsNCiAgICAgIHJldHVybiBOdW1iZXIoeCArIHkgKiAxMCk7DQogICAgfSwNCg0KICAgIC8vIOS4i+agh+aLhuWIhuWdkOaghw0KICAgIHNwbGl0S2V5KGtleSkgew0KICAgICAgaWYgKGtleSA+PSAxMCkgew0KICAgICAgICByZXR1cm4geyB5OiBwYXJzZUludCgoa2V5ICUgMTAwKSAvIDEwKSwgeDoga2V5ICUgMTAgfTsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIHJldHVybiB7IHk6IDAsIHg6IE51bWJlcihrZXkpIH07DQogICAgICB9DQogICAgfSwNCg0KICAgIC8vIOagt+W8j+WkhOeQhg0KICAgIGdldFN0eWxlKHN0eWxlKSB7DQogICAgICBsZXQgcmVzdWx0ID0ge307DQogICAgICBPYmplY3Qua2V5cyhzdHlsZSkubWFwKChrZXkpID0+IHsNCiAgICAgICAgcmVzdWx0W2tleV0gPSBzdHlsZVtrZXldICogNTA7DQoNCiAgICAgICAgaWYgKFsidG9wIiwgImxlZnQiXS5pbmNsdWRlcyhrZXkpKSB7DQogICAgICAgICAgLS1yZXN1bHRba2V5XTsNCiAgICAgICAgfQ0KICAgICAgICBpZiAoWyJ3aWR0aCIsICJoZWlnaHQiXS5pbmNsdWRlcyhrZXkpKSB7DQogICAgICAgICAgKytyZXN1bHRba2V5XTsNCiAgICAgICAgfQ0KICAgICAgICByZXN1bHRba2V5XSArPSAicHgiOw0KICAgICAgfSk7DQoNCiAgICAgIHJldHVybiByZXN1bHQ7DQogICAgfSwNCg0KICAgIGRlbGV0ZUVkaXRXcmFwKGluZGV4KSB7DQogICAgICB0aGlzLm1WYWx1ZS5zcGxpY2UoaW5kZXgsIDEpOw0KICAgICAgdGhpcy5jdXVySW5kZXggPSB0aGlzLm1WYWx1ZS5sZW5ndGggLSAxOw0KICAgIH0sDQoNCiAgICBjbGlja0l0ZW0oaW5kZXgpIHsNCiAgICAgIHRoaXMuY3V1ckluZGV4ID0gaW5kZXg7DQogICAgfSwNCiAgfSwNCn07DQo="},{"version":3,"sources":["CapCubeLayout.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"CapCubeLayout.vue","sourceRoot":"src/custom-schema-template/components/SchemaCapCube","sourcesContent":["<!--\r\n * @Description: 自定义点选布局\r\n * @Autor: WangYuan\r\n * @Date: 2021-06-02 14:18:38\r\n * @LastEditors: WangYuan\r\n * @LastEditTime: 2022-01-27 19:43:28\r\n-->\r\n<template>\r\n  <div class=\"wrap\">\r\n\r\n    <!-- 布局容器 -->\r\n    <ul\r\n      v-for=\"y in ys\"\r\n      :key=\"y\"\r\n      class=\"flex\"\r\n    >\r\n      <li\r\n        v-for=\"x in xs\"\r\n        :key=\"mergeKey(y,x)\"\r\n        :data-key='mergeKey(y,x)'\r\n        :data-y='y'\r\n        :data-x='x'\r\n        class=\"wrap-item flex-center\"\r\n        :class=\"[editKeys.includes(mergeKey(y,x)) ? 'move-wrap':'']\"\r\n        @click='clickWrap($event)'\r\n        @mouseover='move'\r\n      >\r\n        <i class=\"f12 icon icon-jia\"></i>\r\n      </li>\r\n    </ul>\r\n\r\n    <!-- 编辑容器块 -->\r\n    <div\r\n      v-for=\"(item,index) in mValue\"\r\n      :key=\"index\"\r\n      class=\"edit-wrap flex-column flex-center\"\r\n      :class=\"[cuurIndex == index ? 'edit-wrap-active' : '']\"\r\n      :style=\"getStyle(item)\"\r\n      @click=\"clickItem(index)\"\r\n    >\r\n      <div\r\n        v-show=\"model=='custom'\"\r\n        class=\"edit-wrap-close\"\r\n        @click.stop=\"deleteEditWrap(index)\"\r\n      >\r\n        <i class=\"f12 icon icon-cha-\"></i>\r\n      </div>\r\n      <div class=\"mb3\">{{`${parseInt(item.width*62.5)}x${parseInt(item.height*62.5)}`}}</div>\r\n      <div v-show=\"item.width > 1\">或同等比例</div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: \"custom-layout\",\r\n  props: {\r\n    value: {\r\n      type: Array,\r\n      default: () => [],\r\n    },\r\n    model: {\r\n      type: String,\r\n      default: \"custom\",\r\n    },\r\n    row: {\r\n      type: Number,\r\n      default: 10,\r\n    },\r\n  },\r\n  data() {\r\n    return {\r\n      startKey: 0,\r\n      cuurIndex: -1,\r\n      col: 6,\r\n      edit: false, // 编辑模式\r\n      ys: [],\r\n      mValue: [],\r\n      editKeys: [], // 编辑key集合\r\n    };\r\n  },\r\n  computed: {\r\n    xs() {\r\n      return [...Array(this.col).keys()];\r\n    },\r\n  },\r\n  watch: {\r\n    value: {\r\n      immediate: true,\r\n      deep: true,\r\n      handler(newValue, oldValue) {\r\n        this.mValue = newValue;\r\n      },\r\n    },\r\n    mValue: {\r\n      immediate: true,\r\n      deep: true,\r\n      handler(newValue, oldValue) {\r\n        this.$emit(\"input\", newValue);\r\n      },\r\n    },\r\n    row: {\r\n      immediate: true,\r\n      handler(newValue, oldValue) {\r\n        this.ys = [...Array(this.row).keys()];\r\n      },\r\n    },\r\n    cuurIndex: {\r\n      handler(newValue, oldValue) {\r\n        console.log('...');\r\n        \r\n        console.log(newValue);\r\n        \r\n        let temp = newValue == -1 ? undefined : this.mValue[newValue];\r\n        this.$emit(\"onCuurIndex\", temp);\r\n      },\r\n    },\r\n  },\r\n  methods: {\r\n    // 重置容器\r\n    reset() {\r\n      this.startKey = 0;\r\n      this.cuurIndex = -1;\r\n      this.edit = false;\r\n      this.mValue = [];\r\n      this.editKeys = [];\r\n    },\r\n\r\n    // 点击单元块\r\n    clickWrap(e) {\r\n      // 开始编辑模式\r\n      if (!this.edit) {\r\n        let key = e.target.dataset.key;\r\n        this.editKeys.push(Number(key));\r\n        this.startKey = key;\r\n        this.edit = true;\r\n      } else {\r\n        let keys = this.$cloneDeep(this._.sortBy(this.editKeys));\r\n        let start = this.splitKey(keys[0]);\r\n        let end = this.splitKey(keys.pop());\r\n\r\n        // 结束编辑模式\r\n        let temp = {\r\n          top: start.y,\r\n          left: start.x,\r\n          bottom: end.y + 1,\r\n          right: end.x + 1,\r\n          height: end.y - start.y + 1,\r\n          width: end.x - start.x + 1,\r\n          image: \"//d303.paixin.com/thumbs/1561359/378467338/staff_1024.jpg\",\r\n        };\r\n\r\n        this.mValue.push(temp);\r\n        this.cuurIndex = this.mValue.length - 1;\r\n\r\n        this.editKeys = [];\r\n        this.edit = false;\r\n      }\r\n    },\r\n\r\n    // 移动鼠标设置编辑容器\r\n    move(e) {\r\n      if (!this.edit) return;\r\n\r\n      let keys = [];\r\n      let start = this.splitKey(this.startKey);\r\n      let end = this.splitKey(e.target.dataset.key);\r\n      let ys = this._.sortBy([start.y, end.y]);\r\n      let xs = this._.sortBy([start.x, end.x]);\r\n\r\n      // 容器碰撞，阻止编辑容器变更\r\n      if (this.antiCollision(start, end)) {\r\n        return;\r\n      }\r\n\r\n      for (let i = ys[0]; i <= ys[1]; i++) {\r\n        for (let j = xs[0]; j <= xs[1]; j++) {\r\n          keys.push(this.mergeKey(i, j));\r\n        }\r\n      }\r\n\r\n      this.editKeys = keys;\r\n    },\r\n\r\n    // 防碰撞算法\r\n    antiCollision(start, end) {\r\n      let result = false;\r\n\r\n      this.$cloneDeep(this.mValue).map((item) => {\r\n        --item.bottom;\r\n        --item.right;\r\n\r\n        // 判断 x 是否有交集\r\n        if (\r\n          this.$isIntersection(this._.sortBy([start.x, end.x]), [\r\n            item.left,\r\n            item.right,\r\n          ])\r\n        ) {\r\n          // 初始点在目标块y轴上方,结束点大于等于目标块top，发生了碰撞\r\n          if (start.y < item.top && end.y >= item.top) {\r\n            console.log(\"初始点在目标块y轴上方,碰撞了\");\r\n            result = true;\r\n          }\r\n          // 初始点在目标块y轴下方,结束点小于等于目标块bottom，发生了碰撞\r\n          if (start.y > item.bottom && end.y <= item.bottom) {\r\n            console.log(\"初始点在目标块y轴下方,碰撞了\");\r\n            result = true;\r\n          }\r\n        }\r\n\r\n        // 判断 y 是否有交集\r\n        if (\r\n          this.$isIntersection(this._.sortBy([start.y, end.y]), [\r\n            item.top,\r\n            item.bottom,\r\n          ])\r\n        ) {\r\n          // 初始点在目标块y轴左方,结束点大于等于目标块left，发生了碰撞\r\n          if (start.x < item.left && end.x >= item.left) {\r\n            console.log(\"初始点在目标块y轴左方,碰撞了\");\r\n            result = true;\r\n          }\r\n          // 初始点在目标块y轴下方,结束点小于等于目标块bottom，发生了碰撞\r\n          if (start.x > item.right && end.x <= item.right) {\r\n            console.log(\"初始点在目标块y轴右方,碰撞了\");\r\n            result = true;\r\n          }\r\n        }\r\n      });\r\n\r\n      return result;\r\n    },\r\n\r\n    // 坐标计算下标\r\n    mergeKey(y, x) {\r\n      return Number(x + y * 10);\r\n    },\r\n\r\n    // 下标拆分坐标\r\n    splitKey(key) {\r\n      if (key >= 10) {\r\n        return { y: parseInt((key % 100) / 10), x: key % 10 };\r\n      } else {\r\n        return { y: 0, x: Number(key) };\r\n      }\r\n    },\r\n\r\n    // 样式处理\r\n    getStyle(style) {\r\n      let result = {};\r\n      Object.keys(style).map((key) => {\r\n        result[key] = style[key] * 50;\r\n\r\n        if ([\"top\", \"left\"].includes(key)) {\r\n          --result[key];\r\n        }\r\n        if ([\"width\", \"height\"].includes(key)) {\r\n          ++result[key];\r\n        }\r\n        result[key] += \"px\";\r\n      });\r\n\r\n      return result;\r\n    },\r\n\r\n    deleteEditWrap(index) {\r\n      this.mValue.splice(index, 1);\r\n      this.cuurIndex = this.mValue.length - 1;\r\n    },\r\n\r\n    clickItem(index) {\r\n      this.cuurIndex = index;\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.wrap {\r\n  position: relative;\r\n  display: inline-block;\r\n  border-top: 1px solid #e5e5e5;\r\n  border-left: 1px solid #e5e5e5;\r\n\r\n  .wrap-item {\r\n    width: 50px; /* no */\r\n    height: 50px; /* no */\r\n    background: #f8f8f8;\r\n    // border: 1px solid #e5e5e5;\r\n    border-bottom: 1px solid #e5e5e5;\r\n    border-right: 1px solid #e5e5e5;\r\n\r\n    color: #bbb;\r\n    cursor: pointer;\r\n\r\n    i {\r\n      pointer-events: none;\r\n    }\r\n  }\r\n\r\n  .move-wrap {\r\n    background: #e0edff;\r\n\r\n    i {\r\n      display: none;\r\n    }\r\n  }\r\n\r\n  .edit-wrap {\r\n    position: absolute;\r\n    background-color: #fff;\r\n    border: 1px solid #ebedf0;\r\n    font-size: 10px;\r\n    color: #7d7e80;\r\n    z-index: 2;\r\n    cursor: pointer;\r\n\r\n    .edit-wrap-close {\r\n      display: none;\r\n      position: absolute;\r\n      top: -8px;\r\n      right: -8px;\r\n      width: 16px;\r\n      height: 16px;\r\n      line-height: 16px;\r\n      border-radius: 50%;\r\n      background: #b3b3b3;\r\n      color: #fff;\r\n      font-size: 14px;\r\n      text-align: center;\r\n      z-index: 4;\r\n    }\r\n  }\r\n\r\n  .edit-wrap-active {\r\n    background: #e0edff;\r\n    border: 1px solid #155bd4;\r\n    color: #155bd4;\r\n    z-index: 5;\r\n\r\n    &:hover {\r\n      .edit-wrap-close {\r\n        display: block;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>"]}]}